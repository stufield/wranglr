<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Pre-processing data via `create_recipe` • wranglr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Pre-processing data via `create_recipe`">
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">wranglr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/wranglr.html">Get Started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/tips-safely-map-values.html">Safely Map Values via dplyr::left_join()</a></li>
    <li><a class="dropdown-item" href="../articles/tips-safely-rename-df.html">Safely Rename Data Frames</a></li>
    <li><a class="dropdown-item" href="../articles/tips-train-test-setup.html">Common train-test data setups</a></li>
    <li><a class="dropdown-item" href="../articles/simplified-recipes.html">Pre-processing data via `create_recipe`</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Pre-processing data via `create_recipe`</h1>
            
      

      <div class="d-none name"><code>simplified-recipes.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Standard data transformations are common in preparing data for
analysis. Among the most common are:</p>
<ul>
<li>log-transformation</li>
<li>centering with mean zero</li>
<li>scaling to unit variance (<code>sd = 1</code>)</li>
</ul>
<p>which are the typical data preparation steps for proteomic data.</p>
<p>Numerous tools exist in the <code>R</code> ecosystem, including some
relatively new packages, e.g. the <a href="https://recipes.tidymodels.org" class="external-link">recipes</a> package, however comes
with significant implementation costs:</p>
<ol style="list-style-type: decimal">
<li>
<code>recipes</code> is in its infancy, still in a zero-point
release (currently v1.1.0). As such, development is expected to be
ongoing, resulting in likely interface changes and other underlying
changes that would impact end-users. This represents a significant
challenge to create a stable, production environment.</li>
<li>
<code>recipes</code> is designed with a broader use case in mind
than proteomic data. As such, numerous trade-offs and generalizations
must be made to accommodate various data sets it would be required to
act upon.</li>
<li>Many of its assumptions about data format, e.g. feature data vs meta
data, and whether certain features are present in both the training set
and test set are in direct conflict with existing workflows.</li>
<li>
<code>recipes</code> stores large portions of objects inside the
object. While this may be appropriate for smaller, low-dimensional data,
proteomic data with ~5000 features (stretch-goal of &gt; 10k) quickly
becomes unmanageable and results in extremely large objects that must be
saved and incorporated into our production environments for
reproducibility.</li>
</ol>
<p>Given this considerable technical overhead in adopting
<code>recipes</code> as our primary data transformation tool, and the
relatively simple transformations that proteomic data requires, the
technical costs of incorporating <code>recipes</code> into production
level workflows do not seem to balance the solutions it overcomes.</p>
</div>
<div class="section level2">
<h2 id="base-example">Base example<a class="anchor" aria-label="anchor" href="#base-example"></a>
</h2>
<p>We start with a typical pre-processing that can be achieved via
<code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">dplyr::mutate()</a></code> and <code>wranglr</code> S3 dplyr-methods
tools. Combined with the function <code><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10()</a></code>, pre-processing
can be as simple as the following:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">features</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mpg"</span>, <span class="st">"disp"</span>, <span class="st">"drat"</span>, <span class="st">"wt"</span><span class="op">)</span></span>
<span><span class="va">cs</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">{</span>     <span class="co"># .x = numeric vector</span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span>       <span class="co"># log10</span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="va">out</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span> <span class="co"># center</span></span>
<span>  <span class="va">out</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span>          <span class="co"># scale</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># log10/center/scale features</span></span>
<span><span class="va">mt_mod</span> <span class="op">&lt;-</span> <span class="va">mtcars</span></span>
<span><span class="kw">for</span> <span class="op">(</span> <span class="va">i</span> <span class="kw">in</span> <span class="va">features</span> <span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">mt_mod</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">cs</span><span class="op">(</span><span class="va">mt_mod</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># check means of feature data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="fu"><a href="../reference/feature_matrix.html">feature_matrix</a></span><span class="op">(</span><span class="va">mt_mod</span>, <span class="va">features</span><span class="op">)</span>, <span class="fl">2</span>, <span class="va">mean</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">)</span>  <span class="co"># mean = 0</span></span>
<span><span class="co">#&gt; [1] -9.072604e-16</span></span>
<span></span>
<span><span class="co"># check sd of feature data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="fu"><a href="../reference/feature_matrix.html">feature_matrix</a></span><span class="op">(</span><span class="va">mt_mod</span>, <span class="va">features</span><span class="op">)</span>, <span class="fl">2</span>, <span class="va">sd</span><span class="op">)</span></span>
<span><span class="co">#&gt;  mpg disp drat   wt </span></span>
<span><span class="co">#&gt;    1    1    1    1</span></span></code></pre></div>
<div class="section level3">
<h3 id="preprocessing-via-recipes">Preprocessing via <code>recipes</code><a class="anchor" aria-label="anchor" href="#preprocessing-via-recipes"></a>
</h3>
<p>Of course the same result can be achieved via the
<code>recipes</code> package, however not without some unintended
consequences and type conversions:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rcp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://recipes.tidymodels.org/reference/recipe.html" class="external-link">recipe</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://recipes.tidymodels.org/reference/step_log.html" class="external-link">step_log</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="va">features</span><span class="op">)</span>, base <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://recipes.tidymodels.org/reference/step_center.html" class="external-link">step_center</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="va">features</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://recipes.tidymodels.org/reference/step_scale.html" class="external-link">step_scale</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="va">features</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://recipes.tidymodels.org/reference/prep.html" class="external-link">prep</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rcp_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://recipes.tidymodels.org/reference/bake.html" class="external-link">bake</a></span><span class="op">(</span><span class="va">rcp</span>, <span class="va">mtcars</span><span class="op">)</span>    <span class="co"># bake its own recipe</span></span>
<span></span>
<span><span class="fu">waldo</span><span class="fu">::</span><span class="fu"><a href="https://waldo.r-lib.org/reference/compare.html" class="external-link">compare</a></span><span class="op">(</span><span class="va">mt_mod</span>, <span class="va">rcp_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; `class(old)`: <span style="color: #00BB00;">"data.frame"</span>                   </span></span>
<span><span class="co">#&gt; `class(new)`: <span style="color: #00BB00;">"tbl_df"</span>     <span style="color: #00BB00;">"tbl"</span> <span style="color: #00BB00;">"data.frame"</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; `attr(old, 'row.names')` is <span style="color: #00BB00;">a character vector</span> ('Mazda RX4', 'Mazda RX4 Wag', 'Datsun 710', 'Hornet 4 Drive', 'Hornet Sportabout', ...)</span></span>
<span><span class="co">#&gt; `attr(new, 'row.names')` is <span style="color: #00BB00;">an integer vector</span> (1, 2, 3, 4, 5, ...)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      old$mpg             | new$mpg                 </span></span>
<span><span class="co">#&gt;  [1] <span style="color: #00BB00;">0.2921956512698269</span>  - <span style="color: #00BB00;">0.2921956512698287</span>  [1] </span></span>
<span><span class="co">#&gt;  [2] <span style="color: #00BB00;">0.2921956512698269</span>  - <span style="color: #00BB00;">0.2921956512698287</span>  [2] </span></span>
<span><span class="co">#&gt;  [3] <span style="color: #00BB00;">0.5683725639695327</span>  - <span style="color: #00BB00;">0.5683725639695344</span>  [3] </span></span>
<span><span class="co">#&gt;  [4] <span style="color: #00BB00;">0.3555609266619139</span>  - <span style="color: #00BB00;">0.3555609266619156</span>  [4] </span></span>
<span><span class="co">#&gt;  [5] <span style="color: #00BB00;">-0.0973588568470361</span> - <span style="color: #00BB00;">-0.0973588568470344</span> [5] </span></span>
<span><span class="co">#&gt;  [6] <span style="color: #00BB00;">-0.2068770390427560</span> - <span style="color: #00BB00;">-0.2068770390427543</span> [6] </span></span>
<span><span class="co">#&gt;  [7] <span style="color: #00BB00;">-0.9982590624031733</span> - <span style="color: #00BB00;">-0.9982590624031716</span> [7] </span></span>
<span><span class="co">#&gt;  [8] <span style="color: #00BB00;">0.7961384738054255</span>  - <span style="color: #00BB00;">0.7961384738054272</span>  [8] </span></span>
<span><span class="co">#&gt;  [9] <span style="color: #00BB00;">0.5683725639695327</span>  - <span style="color: #00BB00;">0.5683725639695344</span>  [9] </span></span>
<span><span class="co">#&gt; [10] <span style="color: #00BB00;">-0.0087452734091380</span> - <span style="color: #00BB00;">-0.0087452734091362</span> [10]</span></span>
<span><span class="co">#&gt; [11] <span style="color: #00BB00;">-0.2630052530305372</span> - <span style="color: #00BB00;">-0.2630052530305355</span> [11]</span></span>
<span><span class="co">#&gt; [12] <span style="color: #00BB00;">-0.5381042456559998</span> - <span style="color: #00BB00;">-0.5381042456559980</span> [12]</span></span>
<span><span class="co">#&gt; [13] <span style="color: #00BB00;">-0.3586886474273009</span> - <span style="color: #00BB00;">-0.3586886474272992</span> [13]</span></span>
<span><span class="co">#&gt; [14] <span style="color: #00BB00;">-0.7932846747726703</span> - <span style="color: #00BB00;">-0.7932846747726685</span> [14]</span></span>
<span><span class="co">#&gt; [15] <span style="color: #00BB00;">-2.0677094775208662</span> - <span style="color: #00BB00;">-2.0677094775208644</span> [15]</span></span>
<span><span class="co">#&gt; [16] <span style="color: #00BB00;">-2.0677094775208662</span> - <span style="color: #00BB00;">-2.0677094775208644</span> [16]</span></span>
<span><span class="co">#&gt; [17] <span style="color: #00BB00;">-0.9056115325793566</span> - <span style="color: #00BB00;">-0.9056115325793548</span> [17]</span></span>
<span><span class="co">#&gt; [18] <span style="color: #00BB00;">1.7484580182372311</span>  - <span style="color: #00BB00;">1.7484580182372329</span>  [18]</span></span>
<span><span class="co">#&gt; [19] <span style="color: #00BB00;">1.5344837498075696</span>  - <span style="color: #00BB00;">1.5344837498075714</span>  [19]</span></span>
<span><span class="co">#&gt; [20] <span style="color: #00BB00;">1.9004414178059192</span>  - <span style="color: #00BB00;">1.9004414178059210</span>  [20]</span></span>
<span><span class="co">#&gt; [21] <span style="color: #00BB00;">0.3712171786197173</span>  - <span style="color: #00BB00;">0.3712171786197190</span>  [21]</span></span>
<span><span class="co">#&gt; [22] <span style="color: #00BB00;">-0.7276488402979752</span> - <span style="color: #00BB00;">-0.7276488402979735</span> [22]</span></span>
<span><span class="co">#&gt; [23] <span style="color: #00BB00;">-0.7932846747726703</span> - <span style="color: #00BB00;">-0.7932846747726685</span> [23]</span></span>
<span><span class="co">#&gt; [24] <span style="color: #00BB00;">-1.2417178043577795</span> - <span style="color: #00BB00;">-1.2417178043577779</span> [24]</span></span>
<span><span class="co">#&gt; [25] <span style="color: #00BB00;">-0.0087452734091380</span> - <span style="color: #00BB00;">-0.0087452734091362</span> [25]</span></span>
<span><span class="co">#&gt; [26] <span style="color: #00BB00;">1.1732830562164709</span>  - <span style="color: #00BB00;">1.1732830562164727</span>  [26]</span></span>
<span><span class="co">#&gt; [27] <span style="color: #00BB00;">1.0094330013234498</span>  - <span style="color: #00BB00;">1.0094330013234514</span>  [27]</span></span>
<span><span class="co">#&gt; [28] <span style="color: #00BB00;">1.5344837498075696</span>  - <span style="color: #00BB00;">1.5344837498075714</span>  [28]</span></span>
<span><span class="co">#&gt; [29] <span style="color: #00BB00;">-0.6632712785493204</span> - <span style="color: #00BB00;">-0.6632712785493188</span> [29]</span></span>
<span><span class="co">#&gt; [30] <span style="color: #00BB00;">0.0775900716318990</span>  - <span style="color: #00BB00;">0.0775900716319007</span>  [30]</span></span>
<span><span class="co">#&gt; [31] <span style="color: #00BB00;">-0.8377655894612311</span> - <span style="color: #00BB00;">-0.8377655894612295</span> [31]</span></span>
<span><span class="co">#&gt; [32] <span style="color: #00BB00;">0.3555609266619139</span>  - <span style="color: #00BB00;">0.3555609266619156</span>  [32]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      old$disp            | new$disp                </span></span>
<span><span class="co">#&gt;  [1] <span style="color: #00BB00;">-0.3564005693460643</span> - <span style="color: #00BB00;">-0.3564005693460608</span> [1] </span></span>
<span><span class="co">#&gt;  [2] <span style="color: #00BB00;">-0.3564005693460643</span> - <span style="color: #00BB00;">-0.3564005693460608</span> [2] </span></span>
<span><span class="co">#&gt;  [3] <span style="color: #00BB00;">-1.0245268374438461</span> - <span style="color: #00BB00;">-1.0245268374438425</span> [3] </span></span>
<span><span class="co">#&gt;  [4] <span style="color: #00BB00;">0.4557791610670426</span>  - <span style="color: #00BB00;">0.4557791610670460</span>  [4] </span></span>
<span><span class="co">#&gt;  [5] <span style="color: #00BB00;">1.0220856187645546</span>  - <span style="color: #00BB00;">1.0220856187645582</span>  [5] </span></span>
<span><span class="co">#&gt;  [6] <span style="color: #00BB00;">0.2231346137075751</span>  - <span style="color: #00BB00;">0.2231346137075786</span>  [6] </span></span>
<span><span class="co">#&gt;  [7] <span style="color: #00BB00;">1.0220856187645546</span>  - <span style="color: #00BB00;">1.0220856187645582</span>  [7] </span></span>
<span><span class="co">#&gt;  [8] <span style="color: #00BB00;">-0.5039234045752106</span> - <span style="color: #00BB00;">-0.5039234045752070</span> [8] </span></span>
<span><span class="co">#&gt;  [9] <span style="color: #00BB00;">-0.5737022970189927</span> - <span style="color: #00BB00;">-0.5737022970189891</span> [9] </span></span>
<span><span class="co">#&gt; [10] <span style="color: #00BB00;">-0.2775151823110336</span> - <span style="color: #00BB00;">-0.2775151823110301</span> [10]</span></span>
<span><span class="co">#&gt; [11] <span style="color: #00BB00;">-0.2775151823110336</span> - <span style="color: #00BB00;">-0.2775151823110301</span> [11]</span></span>
<span><span class="co">#&gt; [12] <span style="color: #00BB00;">0.5691891772618392</span>  - <span style="color: #00BB00;">0.5691891772618426</span>  [12]</span></span>
<span><span class="co">#&gt; [13] <span style="color: #00BB00;">0.5691891772618392</span>  - <span style="color: #00BB00;">0.5691891772618426</span>  [13]</span></span>
<span><span class="co">#&gt; [14] <span style="color: #00BB00;">0.5691891772618392</span>  - <span style="color: #00BB00;">0.5691891772618426</span>  [14]</span></span>
<span><span class="co">#&gt; [15] <span style="color: #00BB00;">1.4825412480084112</span>  - <span style="color: #00BB00;">1.4825412480084146</span>  [15]</span></span>
<span><span class="co">#&gt; [16] <span style="color: #00BB00;">1.4387650272231167</span>  - <span style="color: #00BB00;">1.4387650272231203</span>  [16]</span></span>
<span><span class="co">#&gt; [17] <span style="color: #00BB00;">1.3632022481877379</span>  - <span style="color: #00BB00;">1.3632022481877415</span>  [17]</span></span>
<span><span class="co">#&gt; [18] <span style="color: #00BB00;">-1.5625194129048876</span> - <span style="color: #00BB00;">-1.5625194129048843</span> [18]</span></span>
<span><span class="co">#&gt; [19] <span style="color: #00BB00;">-1.6285853427586641</span> - <span style="color: #00BB00;">-1.6285853427586607</span> [19]</span></span>
<span><span class="co">#&gt; [20] <span style="color: #00BB00;">-1.7351523848701897</span> - <span style="color: #00BB00;">-1.7351523848701862</span> [20]</span></span>
<span><span class="co">#&gt; [21] <span style="color: #00BB00;">-0.8440103481158979</span> - <span style="color: #00BB00;">-0.8440103481158945</span> [21]</span></span>
<span><span class="co">#&gt; [22] <span style="color: #00BB00;">0.8112106761733330</span>  - <span style="color: #00BB00;">0.8112106761733365</span>  [22]</span></span>
<span><span class="co">#&gt; [23] <span style="color: #00BB00;">0.7346757022991656</span>  - <span style="color: #00BB00;">0.7346757022991690</span>  [23]</span></span>
<span><span class="co">#&gt; [24] <span style="color: #00BB00;">0.9741984343570680</span>  - <span style="color: #00BB00;">0.9741984343570714</span>  [24]</span></span>
<span><span class="co">#&gt; [25] <span style="color: #00BB00;">1.2011861291440837</span>  - <span style="color: #00BB00;">1.2011861291440873</span>  [25]</span></span>
<span><span class="co">#&gt; [26] <span style="color: #00BB00;">-1.5560518744906613</span> - <span style="color: #00BB00;">-1.5560518744906580</span> [26]</span></span>
<span><span class="co">#&gt; [27] <span style="color: #00BB00;">-0.8411819237873273</span> - <span style="color: #00BB00;">-0.8411819237873238</span> [27]</span></span>
<span><span class="co">#&gt; [28] <span style="color: #00BB00;">-1.2407557454981515</span> - <span style="color: #00BB00;">-1.2407557454981479</span> [28]</span></span>
<span><span class="co">#&gt; [29] <span style="color: #00BB00;">0.9790483167604191</span>  - <span style="color: #00BB00;">0.9790483167604226</span>  [29]</span></span>
<span><span class="co">#&gt; [30] <span style="color: #00BB00;">-0.5237371391471235</span> - <span style="color: #00BB00;">-0.5237371391471201</span> [30]</span></span>
<span><span class="co">#&gt; [31] <span style="color: #00BB00;">0.7178172239982828</span>  - <span style="color: #00BB00;">0.7178172239982863</span>  [31]</span></span>
<span><span class="co">#&gt; [32] <span style="color: #00BB00;">-0.8313193363157336</span> - <span style="color: #00BB00;">-0.8313193363157301</span> [32]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      old$drat            | new$drat                </span></span>
<span><span class="co">#&gt;  [1] <span style="color: #00BB00;">0.6174466768968913</span>  - <span style="color: #00BB00;">0.6174466768968895</span>  [1] </span></span>
<span><span class="co">#&gt;  [2] <span style="color: #00BB00;">0.6174466768968913</span>  - <span style="color: #00BB00;">0.6174466768968895</span>  [2] </span></span>
<span><span class="co">#&gt;  [3] <span style="color: #00BB00;">0.5305327519714770</span>  - <span style="color: #00BB00;">0.5305327519714752</span>  [3] </span></span>
<span><span class="co">#&gt;  [4] <span style="color: #00BB00;">-0.9725032383853297</span> - <span style="color: #00BB00;">-0.9725032383853315</span> [4] </span></span>
<span><span class="co">#&gt;  [5] <span style="color: #00BB00;">-0.8211320203832367</span> - <span style="color: #00BB00;">-0.8211320203832385</span> [5] </span></span>
<span><span class="co">#&gt;  [6] <span style="color: #00BB00;">-1.7114061543266874</span> - <span style="color: #00BB00;">-1.7114061543266892</span> [6] </span></span>
<span><span class="co">#&gt;  [7] <span style="color: #00BB00;">-0.6940388965804515</span> - <span style="color: #00BB00;">-0.6940388965804531</span> [7] </span></span>
<span><span class="co">#&gt;  [8] <span style="color: #00BB00;">0.2446230640714255</span>  - <span style="color: #00BB00;">0.2446230640714238</span>  [8] </span></span>
<span><span class="co">#&gt;  [9] <span style="color: #00BB00;">0.6519006431942563</span>  - <span style="color: #00BB00;">0.6519006431942546</span>  [9] </span></span>
<span><span class="co">#&gt; [10] <span style="color: #00BB00;">0.6519006431942563</span>  - <span style="color: #00BB00;">0.6519006431942546</span>  [10]</span></span>
<span><span class="co">#&gt; [11] <span style="color: #00BB00;">0.6519006431942563</span>  - <span style="color: #00BB00;">0.6519006431942546</span>  [11]</span></span>
<span><span class="co">#&gt; [12] <span style="color: #00BB00;">-0.9944080893158254</span> - <span style="color: #00BB00;">-0.9944080893158271</span> [12]</span></span>
<span><span class="co">#&gt; [13] <span style="color: #00BB00;">-0.9944080893158254</span> - <span style="color: #00BB00;">-0.9944080893158271</span> [13]</span></span>
<span><span class="co">#&gt; [14] <span style="color: #00BB00;">-0.9944080893158254</span> - <span style="color: #00BB00;">-0.9944080893158271</span> [14]</span></span>
<span><span class="co">#&gt; [15] <span style="color: #00BB00;">-1.3087994876449272</span> - <span style="color: #00BB00;">-1.3087994876449289</span> [15]</span></span>
<span><span class="co">#&gt; [16] <span style="color: #00BB00;">-1.1497696722005291</span> - <span style="color: #00BB00;">-1.1497696722005306</span> [16]</span></span>
<span><span class="co">#&gt; [17] <span style="color: #00BB00;">-0.6522018942222669</span> - <span style="color: #00BB00;">-0.6522018942222686</span> [17]</span></span>
<span><span class="co">#&gt; [18] <span style="color: #00BB00;">0.9213660047362885</span>  - <span style="color: #00BB00;">0.9213660047362867</span>  [18]</span></span>
<span><span class="co">#&gt; [19] <span style="color: #00BB00;">2.1960501023433925</span>  - <span style="color: #00BB00;">2.1960501023433907</span>  [19]</span></span>
<span><span class="co">#&gt; [20] <span style="color: #00BB00;">1.1486171971444872</span>  - <span style="color: #00BB00;">1.1486171971444854</span>  [20]</span></span>
<span><span class="co">#&gt; [21] <span style="color: #00BB00;">0.2628524005697027</span>  - <span style="color: #00BB00;">0.2628524005697009</span>  [21]</span></span>
<span><span class="co">#&gt; [22] <span style="color: #00BB00;">-1.7114061543266874</span> - <span style="color: #00BB00;">-1.7114061543266892</span> [22]</span></span>
<span><span class="co">#&gt; [23] <span style="color: #00BB00;">-0.8211320203832367</span> - <span style="color: #00BB00;">-0.8211320203832385</span> [23]</span></span>
<span><span class="co">#&gt; [24] <span style="color: #00BB00;">0.3172462551798011</span>  - <span style="color: #00BB00;">0.3172462551797994</span>  [24]</span></span>
<span><span class="co">#&gt; [25] <span style="color: #00BB00;">-0.9725032383853297</span> - <span style="color: #00BB00;">-0.9725032383853315</span> [25]</span></span>
<span><span class="co">#&gt; [26] <span style="color: #00BB00;">0.9213660047362885</span>  - <span style="color: #00BB00;">0.9213660047362867</span>  [26]</span></span>
<span><span class="co">#&gt; [27] <span style="color: #00BB00;">1.4757345384430012</span>  - <span style="color: #00BB00;">1.4757345384429994</span>  [27]</span></span>
<span><span class="co">#&gt; [28] <span style="color: #00BB00;">0.3890947841471895</span>  - <span style="color: #00BB00;">0.3890947841471877</span>  [28]</span></span>
<span><span class="co">#&gt; [29] <span style="color: #00BB00;">1.1486171971444872</span>  - <span style="color: #00BB00;">1.1486171971444854</span>  [29]</span></span>
<span><span class="co">#&gt; [30] <span style="color: #00BB00;">0.1156173421847436</span>  - <span style="color: #00BB00;">0.1156173421847419</span>  [30]</span></span>
<span><span class="co">#&gt; [31] <span style="color: #00BB00;">-0.0349081559688093</span> - <span style="color: #00BB00;">-0.0349081559688110</span> [31]</span></span>
<span><span class="co">#&gt; [32] <span style="color: #00BB00;">0.9707122747061420</span>  - <span style="color: #00BB00;">0.9707122747061403</span>  [32]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      old$wt               | new$wt                   </span></span>
<span><span class="co">#&gt;  [1] <span style="color: #00BB00;">-0.49941878390128880</span> - <span style="color: #00BB00;">-0.49941878390128924</span> [1] </span></span>
<span><span class="co">#&gt;  [2] <span style="color: #00BB00;">-0.20688705243605401</span> - <span style="color: #00BB00;">-0.20688705243605440</span> [2] </span></span>
<span><span class="co">#&gt;  [3] <span style="color: #00BB00;">-0.88243530421712701</span> - <span style="color: #00BB00;">-0.88243530421712735</span> [3] </span></span>
<span><span class="co">#&gt;  [4] <span style="color: #00BB00;">0.14516096952804006</span>  - <span style="color: #00BB00;">0.14516096952803964</span>  [4] </span></span>
<span><span class="co">#&gt;  [5] <span style="color: #00BB00;">0.35821437027258324</span>  - <span style="color: #00BB00;">0.35821437027258285</span>  [5] </span></span>
<span><span class="co">#&gt;  [6] <span style="color: #00BB00;">0.37647310070281231</span>  - <span style="color: #00BB00;">0.37647310070281187</span>  [6] </span></span>
<span><span class="co">#&gt;  [7] <span style="color: #00BB00;">0.47504684719644458</span>  - <span style="color: #00BB00;">0.47504684719644413</span>  [7] </span></span>
<span><span class="co">#&gt;  [8] <span style="color: #00BB00;">0.12057363015642972</span>  - <span style="color: #00BB00;">0.12057363015642932</span>  [8] </span></span>
<span><span class="co">#&gt;  [9] <span style="color: #00BB00;">0.08083023621123864</span>  - <span style="color: #00BB00;">0.08083023621123823</span>  [9] </span></span>
<span><span class="co">#&gt; [10] <span style="color: #00BB00;">0.35821437027258324</span>  - <span style="color: #00BB00;">0.35821437027258285</span>  [10]</span></span>
<span><span class="co">#&gt; [11] <span style="color: #00BB00;">0.35821437027258324</span>  - <span style="color: #00BB00;">0.35821437027258285</span>  [11]</span></span>
<span><span class="co">#&gt; [12] <span style="color: #00BB00;">0.88789114488029719</span>  - <span style="color: #00BB00;">0.88789114488029686</span>  [12]</span></span>
<span><span class="co">#&gt; [13] <span style="color: #00BB00;">0.61313459177967622</span>  - <span style="color: #00BB00;">0.61313459177967589</span>  [13]</span></span>
<span><span class="co">#&gt; [14] <span style="color: #00BB00;">0.65507425511759743</span>  - <span style="color: #00BB00;">0.65507425511759698</span>  [14]</span></span>
<span><span class="co">#&gt; [15] <span style="color: #00BB00;">1.68973795019723827</span>  - <span style="color: #00BB00;">1.68973795019723783</span>  [15]</span></span>
<span><span class="co">#&gt; [16] <span style="color: #00BB00;">1.79243287435869503</span>  - <span style="color: #00BB00;">1.79243287435869458</span>  [16]</span></span>
<span><span class="co">#&gt; [17] <span style="color: #00BB00;">1.74622159834988744</span>  - <span style="color: #00BB00;">1.74622159834988699</span>  [17]</span></span>
<span><span class="co">#&gt; [18] <span style="color: #00BB00;">-1.04971118792495810</span> - <span style="color: #00BB00;">-1.04971118792495854</span> [18]</span></span>
<span><span class="co">#&gt; [19] <span style="color: #555555;">-2.02332996647317076</span> | <span style="color: #555555;">-2.02332996647317076</span> [19]</span></span>
<span><span class="co">#&gt; [20] <span style="color: #00BB00;">-1.62109321465024414</span> - <span style="color: #00BB00;">-1.62109321465024458</span> [20]</span></span>
<span><span class="co">#&gt; [21] <span style="color: #00BB00;">-0.69149065077775929</span> - <span style="color: #00BB00;">-0.69149065077775973</span> [21]</span></span>
<span><span class="co">#&gt; [22] <span style="color: #00BB00;">0.43062266674731864</span>  - <span style="color: #00BB00;">0.43062266674731819</span>  [22]</span></span>
<span><span class="co">#&gt; [23] <span style="color: #00BB00;">0.35363310084151861</span>  - <span style="color: #00BB00;">0.35363310084151817</span>  [23]</span></span>
<span><span class="co">#&gt; [24] <span style="color: #00BB00;">0.70467562950020202</span>  - <span style="color: #00BB00;">0.70467562950020157</span>  [24]</span></span>
<span><span class="co">#&gt; [25] <span style="color: #00BB00;">0.70877403239280801</span>  - <span style="color: #00BB00;">0.70877403239280767</span>  [25]</span></span>
<span><span class="co">#&gt; [26] <span style="color: #00BB00;">-1.45396530125925372</span> - <span style="color: #00BB00;">-1.45396530125925416</span> [26]</span></span>
<span><span class="co">#&gt; [27] <span style="color: #00BB00;">-1.13680306427445688</span> - <span style="color: #00BB00;">-1.13680306427445732</span> [27]</span></span>
<span><span class="co">#&gt; [28] <span style="color: #00BB00;">-2.22881296109019011</span> - <span style="color: #00BB00;">-2.22881296109019056</span> [28]</span></span>
<span><span class="co">#&gt; [29] <span style="color: #00BB00;">0.10076462034095805</span>  - <span style="color: #00BB00;">0.10076462034095765</span>  [29]</span></span>
<span><span class="co">#&gt; [30] <span style="color: #00BB00;">-0.32406986071302141</span> - <span style="color: #00BB00;">-0.32406986071302185</span> [30]</span></span>
<span><span class="co">#&gt; [31] <span style="color: #00BB00;">0.47504684719644458</span>  - <span style="color: #00BB00;">0.47504684719644413</span>  [31]</span></span>
<span><span class="co">#&gt; [32] <span style="color: #00BB00;">-0.31271985859783663</span> - <span style="color: #00BB00;">-0.31271985859783707</span> [32]</span></span></code></pre></div>
<p>The two objects are <em>NOT</em> the same … significant modifications
have occurred and perhaps most significantly, it is done so
invisibly:</p>
</div>
</div>
<div class="section level2">
<h2 id="an-alternative-workflow">An alternative workflow<a class="anchor" aria-label="anchor" href="#an-alternative-workflow"></a>
</h2>
<p>The vast majority of proteomics pre-processing involves 3 main
steps:</p>
<ol style="list-style-type: decimal">
<li>log10-transformation</li>
<li>center to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\mu = 0</annotation></semantics></math>
</li>
<li>scale to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sigma = 1</annotation></semantics></math>
</li>
</ol>
<p>where this pre-processing is first applied to a training set and
therefore must also be applied to the test set. The new recipe ecosystem
defaults are set up to accommodate this workflow.</p>
<p>The goal is to provide users with the most beneficial aspects of
<code>recipes</code> without the imposed costs of stepping into the
<code>recipes</code> ecosystem. We will introduce 2 new user-facing
functions:</p>
<ul>
<li><code><a href="../reference/create_recipe.html">create_recipe()</a></code></li>
<li><code><a href="../reference/create_recipe.html">bake_recipe()</a></code></li>
</ul>
<p>First, create train/test sets:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span>      <span class="op">&lt;-</span> <span class="fl">5L</span></span>
<span><span class="va">train</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="op">-</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">test</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="va">n</span><span class="op">)</span></span></code></pre></div>
<p>Set up the <code>rcp</code> processing controller object (as in
<code>recipes</code>), however it combines the
<code><a href="https://recipes.tidymodels.org/reference/recipe.html" class="external-link">recipes::recipe()</a></code> and <code><a href="https://recipes.tidymodels.org/reference/prep.html" class="external-link">recipes::prep()</a></code> into one
step:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use the defaults: log10 -&gt; center -&gt; scale</span></span>
<span><span class="co"># add some modifications on-the-fly: sqrt(), log10(), function(x)</span></span>
<span><span class="va">rcp_</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_recipe.html">create_recipe</a></span><span class="op">(</span><span class="va">train</span>,</span>
<span>                      feat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mpg"</span>, <span class="st">"disp"</span>, <span class="st">"drat"</span>, <span class="st">"wt"</span><span class="op">)</span>,</span>
<span>                      disp <span class="op">=</span> <span class="va">sqrt</span>,</span>
<span>                      hp   <span class="op">=</span> <span class="va">log</span>,</span>
<span>                      qsec <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">x</span> <span class="op">/</span> <span class="fl">10</span>, <span class="fl">1L</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># new class object</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">rcp_</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "rcp"  "list"</span></span>
<span></span>
<span><span class="co"># S3 print</span></span>
<span><span class="va">rcp_</span></span>
<span><span class="co">#&gt; ══ Pre-processing recipe ═════════════════════════════════════════════════</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ─── Training data:</span></span>
<span><span class="co">#&gt; ✓ Data containing 27 samples used in recipe</span></span>
<span><span class="co">#&gt; ✓ RFU features ( n = 4 ) will be processed by:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ─── Steps:</span></span>
<span><span class="co">#&gt; • log10-transformed      ✓</span></span>
<span><span class="co">#&gt; • Centered (mean = 0)    ✓</span></span>
<span><span class="co">#&gt; • Scaled (sd = 1)        ✓</span></span>
<span><span class="co">#&gt; ✓ Additional processing:</span></span>
<span><span class="co">#&gt; • disp                  sqrt</span></span>
<span><span class="co">#&gt; • hp                    log</span></span>
<span><span class="co">#&gt; • qsec                  function(x) round(x/10, 1L)</span></span>
<span><span class="co">#&gt; ══════════════════════════════════════════════════════════════════════════</span></span>
<span></span>
<span><span class="co"># the recipe contains a processing parameter table</span></span>
<span><span class="va">rcp_</span><span class="op">$</span><span class="va">par_tbl</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 3</span></span></span>
<span><span class="co">#&gt;   feature means    sds</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> mpg     1.28  0.133 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> disp    1.15  0.130 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> drat    0.545 0.067<span style="text-decoration: underline;">3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> wt      0.499 0.136</span></span></code></pre></div>
<p>Compared to a <code>recipe</code> class object, a <code>rcp</code> is
much smaller and accomplishes the same task:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">lobstr</span><span class="fu">::</span><span class="fu"><a href="https://lobstr.r-lib.org/reference/obj_size.html" class="external-link">obj_size</a></span><span class="op">(</span><span class="va">rcp</span><span class="op">)</span></span>
<span><span class="co">#&gt; 25.22 kB</span></span>
<span></span>
<span><span class="fu">lobstr</span><span class="fu">::</span><span class="fu"><a href="https://lobstr.r-lib.org/reference/obj_size.html" class="external-link">obj_size</a></span><span class="op">(</span><span class="va">rcp_</span><span class="op">)</span></span>
<span><span class="co">#&gt; 5.44 kB</span></span></code></pre></div>
<p>Now apply the recipe in the familiar “bake” style:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">baked_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_recipe.html">bake_recipe</a></span><span class="op">(</span><span class="va">rcp_</span>, <span class="va">test</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># convenient to know if data has been "baked"</span></span>
<span><span class="fu"><a href="../reference/create_recipe.html">is.baked</a></span><span class="op">(</span><span class="va">baked_test</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="va">baked_test</span></span>
<span><span class="co">#&gt;                        mpg cyl       disp       hp       drat          wt</span></span>
<span><span class="co">#&gt; Lotus Europa    1.51262140   4 -1.2504330 4.727388 0.46466494 -2.34080684</span></span>
<span><span class="co">#&gt; Ford Pantera L -0.62969458   8  0.9282225 5.575949 1.19235920  0.01614505</span></span>
<span><span class="co">#&gt; Ferrari Dino    0.09247831   6 -0.5467058 5.164786 0.20264770 -0.41368156</span></span>
<span><span class="co">#&gt; Maserati Bora  -0.79978722   8  0.6718339 5.814131 0.05843004  0.39482538</span></span>
<span><span class="co">#&gt; Volvo 142E      0.36343727   4 -0.8485863 4.691348 1.02190947 -0.40219819</span></span>
<span><span class="co">#&gt;                qsec vs am gear carb</span></span>
<span><span class="co">#&gt; Lotus Europa    1.7  1  1    5    2</span></span>
<span><span class="co">#&gt; Ford Pantera L  1.4  0  1    5    4</span></span>
<span><span class="co">#&gt; Ferrari Dino    1.6  0  1    5    6</span></span>
<span><span class="co">#&gt; Maserati Bora   1.5  0  1    5    8</span></span>
<span><span class="co">#&gt; Volvo 142E      1.9  1  1    4    2</span></span></code></pre></div>
<div class="section level3">
<h3 id="what-about-non-feature-variables">What about non-Feature variables?<a class="anchor" aria-label="anchor" href="#what-about-non-feature-variables"></a>
</h3>
<p>In the above example 3 variables have been processed via the
<code>...</code> mechanism. Arguments should be passed <code>...</code>
in the form <code>variable = function()</code> You may also pass
anonymous functions “on-the-fly”, where functions should take a vector
input and return a vector of the same length. It is important to realize
that these transformations take place <em>before</em> the center-scale
transformation in the case where features <em>and</em> “dot”-mechanism
variables are processed.</p>
<ul>
<li>
<code>disp</code>: was square rooted (prior to log &gt; center &gt;
scale)</li>
<li>
<code>hp</code>: log_e-transformed</li>
<li>
<code>qseq</code>: anonymous function divide by 10 and round to 1
decimal place</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the 'additional' modified variables</span></span>
<span><span class="va">rcp_</span><span class="op">$</span><span class="va">dot_vars</span></span>
<span><span class="co">#&gt; [1] "disp" "hp"   "qsec"</span></span>
<span></span>
<span><span class="co"># compare modified meta data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">test</span><span class="op">[</span>, <span class="va">rcp_</span><span class="op">$</span><span class="va">dot_vars</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 3</span></span></span>
<span><span class="co">#&gt;    disp    hp  qsec</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  95.1   113  16.9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 351     264  14.5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 145     175  15.5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 301     335  14.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 121     109  18.6</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">baked_test</span><span class="op">[</span>, <span class="va">rcp_</span><span class="op">$</span><span class="va">dot_vars</span><span class="op">]</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 5 × 3</span></span></span>
<span><span class="co">#&gt;     disp    hp  qsec</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> -<span style="color: #BB0000;">1.25</span>   4.73   1.7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  0.928  5.58   1.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> -<span style="color: #BB0000;">0.547</span>  5.16   1.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  0.672  5.81   1.5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> -<span style="color: #BB0000;">0.849</span>  4.69   1.9</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="underlying-machinery">Underlying machinery<a class="anchor" aria-label="anchor" href="#underlying-machinery"></a>
</h2>
<p>The main underlying non-user-facing function to center and/or scale
data is <code><a href="../reference/center_scale.html">center_scale()</a></code>.</p>
<div class="section level3">
<h3 id="center_scale">
<code>center_scale()</code><a class="anchor" aria-label="anchor" href="#center_scale"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cs_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/center_scale.html">center_scale</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># check new class</span></span>
<span><span class="fu"><a href="../reference/center_scale.html">is_center_scaled</a></span><span class="op">(</span><span class="va">cs_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="co"># get the parameter table</span></span>
<span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">cs_data</span>, <span class="st">"par_tbl"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># center/scale test based on train parameters</span></span>
<span><span class="va">test_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/center_scale.html">center_scale</a></span><span class="op">(</span><span class="va">pars</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="revert-with-undo_center_scale">Revert with <code>undo_center_scale()</code><a class="anchor" aria-label="anchor" href="#revert-with-undo_center_scale"></a>
</h3>
<p>You can simply undo any center/scaling that has occurred via
<code><a href="../reference/center_scale.html">undo_center_scale()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">old</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/center_scale.html">undo_center_scale</a></span><span class="op">(</span><span class="va">test_mod</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Safe-guards are in place so that you cannot double-undo:</span></span>
<span><span class="co">#   `par_tbl` entry is removed from attributes</span></span>
<span><span class="fu"><a href="../reference/center_scale.html">undo_center_scale</a></span><span class="op">(</span><span class="va">old</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in undo_center_scale(old): Must perform `undo` on previously center/scaled data.</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/stufield" class="external-link">Stu Field</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

  </div></footer>
</body>
</html>
